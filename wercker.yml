box:
  id: alpine:3.2
build:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
    - bash-template
    - script:
        name: "visualise kubernetes config"
        code: cat ./atp-binding-plain.yaml

create-atp:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
    - bash-template
    - kubectl:
        name: create atp instance
        server: $KUBERNETES_MASTER
        token: $KUBERNETES_TOKEN
        insecure-skip-tls-verify: true
        command: create -f ./atp-instance-plain.yaml

create-atp-binding:
    box:
      id: alpine
      cmd: /bin/sh
    steps:
      - bash-template
    - kubectl:
        name: create atp binding
        server: $KUBERNETES_MASTER
        token: $KUBERNETES_TOKEN
        insecure-skip-tls-verify: true
        command: create -f ./atp-instance-plain.yaml
