box:
  id: alpine:3.2
build:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
  - bash-template
  - script:
      name: "visualise kubernetes config"
      code: cat ./atp-binding-plain.yaml

create-atp-instance:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
  - bash-template
  - kubectl:
      name: create atp instance
      server: $KUBERNETES_MASTER
      token: $KUBERNETES_TOKEN
      insecure-skip-tls-verify: true
      command: create -f ./atp-instance-plain.yaml

create-atp-binding:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
  - bash-template
  - kubectl:
      name: create atp binding
      server: $KUBERNETES_MASTER
      token: $KUBERNETES_TOKEN
      insecure-skip-tls-verify: true
      command: create -f ./atp-binding-plain.yaml

create-atp-pre-secret:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
  - bash-template
  - script:
      name: "visualise kubernetes config"
      code: cat ./atp-demo-secret.yaml
  - script:
      name: "show environment variables"
      code: |
        echo -n $WALLET_PASSWORD | base64
        # export EN_WALLET_PASSWORD=\$\(echo -n $WALLET_PASSWORD | base64 \)
        # export EN_DB_PASSWORD=\$\(echo -n $DB_PASSWORD | base64 \)
        # echo \"$EN_WALLET_PASSWORD  $EN_DB_PASSWORD\"
        # sed -i '~
 
create-atp-secret:
  box:
    id: alpine
    cmd: /bin/sh
  steps:
  - bash-template
  - kubectl:
      name: create atp secret
      server: $KUBERNETES_MASTER
      token: $KUBERNETES_TOKEN
      insecure-skip-tls-verify: true
      command: create -f ./atp-demo-secret.yaml
